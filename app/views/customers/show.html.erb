<% provide(:title, @customer.customer_name) %>
<%= render 'layouts/manager_or_customer_dashboard' %>
<div id="page-wrapper">
	<%= render 'layouts/alerts' %>
	<div class="row">
  	<aside class="col-lg-12">
    	<section class="user_info">
    		<div class="page-header">
      		<h3>
      			<%= @customer.customer_name %>
      				<small>
      					Contact: <%= @customer.contact_first_name %> <%= @customer.contact_last_name %>
      				</small>
      		</h3>
      	</div>
      	<!-- /.page-header -->
        <% if @customer.approved? && user_logged_in? && current_user.admin? %>
          <h4>
            Admin Options:
          </h4>
          <div class="btn-group" role="group" aria-label="Justified button group">
            <% if @customer.active? %>
             <%= link_to "Deactivate Account", deactivate_customer_customer_path(id: @customer.id), class: "btn btn-danger", role:"button", :data => {:confirm => "Are you sure you want to deactivate #{@customer.customer_name}'s account? They will no longer be able to use the site."} %>
            <% else %>
              <%= link_to "Reactivate Account", reactivate_customer_customer_path(id: @customer.id), class: "btn btn-success", role:"button", :data => {:confirm => "Are you sure you want to reactivate #{@customer.customer_name}'s account? They will be able to use the site again."} %>
            <% end%>
          </div>
          <!-- /.btn-group btn-group-justified -->
        <% elsif !@customer.approved? && user_logged_in? && current_user.manager? %>
          <h4>
            Manager Options:
          </h4>
          <div class="btn-group" role="group" aria-label="Justified button group">
            <%= link_to "Approve Account Request", approve_account_customer_path(id: @customer.id), class: "btn btn-success", role:"button", :data => {:confirm => "Are you sure you want to approve the account request for #{@customer.customer_name}? They will be notified via email."} %>
            <%= link_to "Deny Account Request", @customer, method: :delete, class: "btn btn-danger", role:"button", :data => {:confirm => "Are you sure you want to permanently deny the account request for #{@customer.customer_name}? (Warning: This cannot be reversed.)"} %>
          </div>
          <!-- /.btn-group btn-group-justified -->
        <% end %>
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>
                TSHA Number
              </th>
              <th>
                System ID
              </th>
              <th>
                Customer Name
              </th>
              <th>
                Email
              </th>
              <th>
                Fax Number
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <%= @customer.tsha_number %>
              </td>
              <td>
                <%= @customer.id %>
              </td>
              <td>
                <%= @customer.customer_name %>
              </td>
              <td>
                <%= @customer.email %>
              </td>
              <td>
                <%= @customer.fax %>
              </td>
            </tr>
          </tbody>
          <thead>
            <tr>
              <th>
                Customer Phone
              </th>
              <th>
                Phone Ext.
              </th>
              <th>
                Contact Name
              </th>
              <th>
                Contact Phone
              </th>
              <th>
                Contact Phone Ext.
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <%= @customer.phone_number %>
              </td>
              <td>
                <%= @customer.phone_number_extension %>
              </td>
              <td>
                <%= @customer.contact_first_name %> <%= @customer.contact_last_name %>
              </td>
              <td>
                <%= @customer.contact_phone_number %>
              </td>
              <td>
                <%= @customer.contact_phone_number_extension %>
              </td>
            </tr>
          </tbody>
          <% if user_logged_in? && current_user.manager? %>
            <thead>
              <tr>
                <th>
                  Fund Number
                </th>
                <th>
                </th>
                <th>
                </th>
                <th>
                </th>
                <th>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <%= @customer.fund_number %>
                </td>
                <td>
                </td>
                <td>
                </td>
                <td>
                </td>
                <td>
                </td>
              </tr>
            </tbody>
          <% end %>
        </table>
        <!-- /.table table-striped table-hover -->
        <% if @customer.approved? && user_logged_in? && current_user.manager? %>
          <h4>
            Change Customer's TSHA #
          </h4>
          <%= form_for @customer, url: change_tsha_number_customer_path(@customer) do |f| %>
            <%= f.text_field :tsha_number %>
            <button type="submit" class="button">Update TSHA #</button>
          <% end %>
          <h4>
            Change Customer's Fund #
          </h4>
          <%= form_for @customer, url: change_fund_number_customer_path(@customer) do |f| %>
            <%= f.text_field :fund_number %>
            <button type="submit" class="button">Update Fund #</button>
          <% end %>
        <% end %>
        <div class="panel panel-info">
          <div class="panel-heading">
            <h3 class="panel-title">
              Billing Address:
            </h3>
            <!-- /.panel-title -->
          </div>
          <!-- /.panel-heading -->
          <div class="panel-body">
            <% if @customer.billing_address_line_1 %>
              <%= @customer.billing_address_line_1 %>
            <% end %>
            <% if @customer.billing_address_line_2 %>
              <br>
              <%= @customer.billing_address_line_2 %>
            <% end %>
            <% if @customer.billing_address_line_3 %>
              <br>
              <%= @customer.billing_address_line_3 %>
            <% end %>
          </div>
          <!-- /.panel-body -->
        </div>
        <!-- /. panel panel-info -->
        <div class="panel panel-info">
          <div class="panel-heading">
            <h3 class="panel-title">
              Mail Address:
            </h3>
            <!-- /.panel-title -->
          </div>
          <!-- /.panel-heading -->
          <div class="panel-body">
            <% if @customer.mail_address_line_1 %>
              <%= @customer.mail_address_line_1 %>
            <% end %>
            <% if @customer.mail_address_line_2 %>
              <br>
              <%= @customer.mail_address_line_2 %>
            <% end %>
            <% if @customer.mail_address_line_3 %>
              <br>
              <%= @customer.mail_address_line_3 %>
            <% end %>
          </div>
          <!-- /.panel-body -->
        </div>
        <!-- /. panel panel-info -->
    	</section>
    	<!-- /.user_info -->
  	</aside>
  	<!-- /.col-lg-12 -->
	</div>
	<!-- /.row -->
</div>
<!-- /.page-wrapper -->
