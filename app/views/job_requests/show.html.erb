<% provide(:title, "Job Request #{@job_request.id}") %>
<% if customer_logged_in? %>
  <%= render 'layouts/customer_dashboard' %>
<% elsif user_logged_in? && current_user.manager? %>
  <%= render 'layouts/manager_dashboard' %>
<% end %>
<div id="page-wrapper">
  <%= render 'layouts/alerts' %>
  <div class="row">
    <aside class="col-lg-12">
      <% if user_logged_in? && current_user.manager? %>
        <td>
          <% if @job_request.awaiting_approval? %>
            <span class="label label-warning">Awaiting Approval</span>
            <%= link_to "Create Job From Job Request", new_job_from_job_request_job_path(
             :customer_id => @job_request.customer.id, :job_request_id => @job_request.id,
             :start => @job_request.start, :end => @job_request.end,
             :requester_first_name => @job_request.requester_first_name,
             :requester_last_name => @job_request.requester_last_name,
             :requester_email => @job_request.requester_email,
             :requester_phone_number => @job_request.requester_phone_number,
             :contact_person_first_name => @job_request.contact_person_first_name,
             :contact_person_last_name => @job_request.contact_person_last_name,
             :address_line_1 => @job_request.event_location_address_line_1,
             :address_line_2 => @job_request.event_location_address_line_2,
             :address_line_3 => @job_request.event_location_address_line_3,
             :city => @job_request.city, :state => @job_request.state, :zip => @job_request.zip), :class => "btn btn-primary" %>
            <%= link_to "Approve", approve_job_request_user_path(job_request_id: @job_request.id), class: "btn btn-success", role:"button", :data => {:confirm => "Are you sure you want to mark this job request as approved?"} %>
            <%= link_to "Reject", reject_job_request_user_path(job_request_id: @job_request.id), class: "btn btn-danger", role:"button", :data => {:confirm => "Are you sure you want to mark this job request as rejected?"} %>
          <% elsif @job_request.accepted? %>
            <span class="label label-success">Approved on <%= @job_request.accepted_at.strftime("%A, %d %b %Y %l:%M %p") %></span>
            <%= link_to "Create Job From Job Request", new_job_from_job_request_job_path(
             :customer_id => @job_request.customer.id, :job_request_id => @job_request.id,
             :start => @job_request.start, :end => @job_request.end,
             :requester_first_name => @job_request.requester_first_name,
             :requester_last_name => @job_request.requester_last_name,
             :requester_email => @job_request.requester_email,
             :requester_phone_number => @job_request.requester_phone_number,
             :contact_person_first_name => @job_request.contact_person_first_name,
             :contact_person_last_name => @job_request.contact_person_last_name,
             :address_line_1 => @job_request.event_location_address_line_1,
             :address_line_2 => @job_request.event_location_address_line_2,
             :address_line_3 => @job_request.event_location_address_line_3,
             :city => @job_request.city, :state => @job_request.state, :zip => @job_request.zip), :class => "btn btn-primary" %>
          <% elsif @job_request.denied? %>
            <span class="label label-danger">Rejected on <%= @job_request.denied_at.strftime("%A, %d %b %Y %l:%M %p") %></span>
          <% elsif @job_request.expired? %>
            <span class="label label-danger">Expired on <%= @job_request.expired_at.strftime("%A, %d %b %Y %l:%M %p") %></span>
          <% end %>
        </td>
      <% end %>
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>
              Job Request ID
            </th>
            <th>
              Requester
            </th>
            <th>
              Office/Business Name
            </th>
            <th>
               Requester Email
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <%= @job_request.id %>
            </td>
            <td>
              <%= @job_request.requester_first_name %> <%= @job_request.requester_last_name %>
            </td>
            <td>
              <%= @job_request.office_business_name %>
            </td>
            <td>
              <%= @job_request.requester_email %>
            </td>
          </tr>
        </tbody>
        <thead>
          <tr>
            <th>
             Requester Phone Number
            </th>
            <th>
              Requester Fax Number
            </th>
            <th>
              Event Start
            </th>
            <th>
              Event End
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <%= @job_request.requester_phone_number %>
            </td>
            <td>
              <%= @job_request.requester_fax_number %>
            </td>
            <td>
              <%= @job_request.start.strftime("%A, %d %b %Y %l:%M %p") %>
            </td>
            <td>
              <%= @job_request.end.strftime("%A, %d %b %Y %l:%M %p") %>
            </td>
          </tr>
        </tbody>
        <thead>
          <tr>
            <th>
              Deaf Client
            </th>
            <th>
              Contact Person
            </th>
            <th>
              Office Phone Number
            </th>
            <th>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <%= @job_request.deaf_client_first_name %> <%= @job_request.deaf_client_last_name %>
            </td>
            <td>
              <%= @job_request.contact_person_first_name %> <%= @job_request.contact_person_last_name %>
            </td>
            <td>
              <%= @job_request.office_phone_number %>
            </td>
            <td>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- /.table table-striped table-hover -->
      <div class="panel panel-info">
        <div class="panel-heading">
          <h3 class="panel-title">
            Address:
          </h3>
          <!-- /.panel-title -->
        </div>
        <!-- /.panel-heading -->
        <div class="panel-body">
          <% if @job_request.event_location_address_line_1.length != 0 %>
            <%= @job_request.event_location_address_line_1 %>
          <% end %>
          <% if @job_request.event_location_address_line_2.length != 0 %>
            <br>
            <%= @job_request.event_location_address_line_2 %>
          <% end %>
          <% if @job_request.event_location_address_line_3.length != 0 %>
            <br>
            <%= @job_request.event_location_address_line_3 %>
          <% end %>
        </div>
        <!-- /.panel-body -->
      </div>
      <!-- /. panel panel-info -->
      <div class="panel panel-info">
        <div class="panel-heading">
          <h3 class="panel-title">
            Type of Appointment / Situation:
          </h3>
          <!-- /.panel-title -->
        </div>
        <!-- /.panel-heading -->
        <div class="panel-body">
          <% if @job_request.type_of_appointment_situation.length != 0 %>
            <%= @job_request.type_of_appointment_situation %>
          <% else %>
            N/A
          <% end %>
        </div>
        <!-- /.panel-body -->
      </div>
      <!-- /. panel panel-info -->
      <div class="panel panel-info">
        <div class="panel-heading">
          <h3 class="panel-title">
            Message from Customer
          </h3>
          <!-- /.panel-title -->
        </div>
        <!-- /.panel-heading -->
        <div class="panel-body">
          <% if @job_request.message.length != 0 %>
            <%= @job_request.message %>
          <% else %>
            N/A
          <% end %>
        </div>
        <!-- /.panel-body -->
      </div>
      <!-- /. panel panel-info -->
    </aside>
    <!-- /.col-md-4 -->
  </div>
  <!-- /.row -->
</div>
<!-- /.page-wrapper -->
